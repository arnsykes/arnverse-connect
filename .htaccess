# ===================================================================
# ARNVERSE SPA Routing Configuration untuk cPanel/LiteSpeed
# File ini harus ditempatkan di: /public_html/arnworld.space/.htaccess
# ===================================================================

# Disable MultiViews untuk menghindari konflik dengan SPA routing
Options -MultiViews

# Enable RewriteEngine
RewriteEngine On
RewriteBase /

# ===================================================================
# STEP 1: Layani file dan folder yang benar-benar ada
# ===================================================================
# Jika request adalah file yang ada (misal: index.html, app.js, style.css)
# atau folder yang ada (misal: /assets, /images), maka layani apa adanya
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# ===================================================================
# STEP 2: Jangan ganggu endpoint API PHP
# ===================================================================
# Semua request ke /api/* diteruskan ke server PHP tanpa fallback
# Ini penting agar /api/login.php, /api/feed.php, dll tetap berfungsi
RewriteRule ^api/ - [L]

# ===================================================================
# STEP 3: Fallback semua route SPA ke index.html
# ===================================================================
# Untuk semua request lainnya (misal: /login, /explore, /profile/user123)
# yang bukan file/folder nyata dan bukan API, arahkan ke index.html
# sehingga React Router dapat menangani routing client-side
RewriteRule ^ index.html [L]

# ===================================================================
# Security Headers (opsional, untuk keamanan tambahan)
# ===================================================================
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# ===================================================================
# Cache Control untuk aset static (opsional, untuk performa)
# ===================================================================
<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
</IfModule>